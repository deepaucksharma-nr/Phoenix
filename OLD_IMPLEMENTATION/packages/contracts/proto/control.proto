syntax = "proto3";

package phoenix.control.v1;

option go_package = "github.com/deepaucksharma/phoenix/modules/phoenix-contracts/gen/go/control/v1";

// OptimizationMode represents the cardinality optimization profile
enum OptimizationMode {
  OPTIMIZATION_MODE_UNSPECIFIED = 0;
  OPTIMIZATION_MODE_CONSERVATIVE = 1;
  OPTIMIZATION_MODE_BALANCED = 2;
  OPTIMIZATION_MODE_AGGRESSIVE = 3;
}

// ControlSignal represents a control decision
message ControlSignal {
  OptimizationMode mode = 1;
  int64 timestamp_nanos = 2;
  string reason = 3;
  double confidence = 4;
}

// KPIMetrics contains key performance indicators
message KPIMetrics {
  int64 cardinality_estimate = 1;
  double cpu_utilization = 2;
  double memory_utilization = 3;
  double processing_latency_ms = 4;
  int64 dropped_metrics_count = 5;
}

// ControlRequest for manual control override
message ControlRequest {
  OptimizationMode desired_mode = 1;
  int32 duration_seconds = 2;
  string reason = 3;
}

// ControlResponse acknowledges control change
message ControlResponse {
  bool success = 1;
  string message = 2;
  OptimizationMode current_mode = 3;
  OptimizationMode previous_mode = 4;
}

// StatusRequest for querying control status
message StatusRequest {}

// StatusResponse contains current control state
message StatusResponse {
  OptimizationMode current_mode = 1;
  KPIMetrics current_kpis = 2;
  repeated ControlSignal recent_signals = 3;
  int64 uptime_seconds = 4;
}